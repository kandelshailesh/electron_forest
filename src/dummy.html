<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
    <title>झिमझिमे सामुदायिक वन</title>
    <link rel="stylesheet" type="text/css" href="../node_modules/bootstrap/dist/css/bootstrap.min.css">
    
    <script src="../node_modules/jquery/dist/jquery.js"></script>
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.1.3/css/bootstrap.min.css">


<!-- jQuery library -->
<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
<script src="jhimjhime.js"></script>


<!-- Popper JS -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.3/umd/popper.min.js"></script>

<!-- Latest compiled JavaScript -->
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.1.3/js/bootstrap.min.js"></script>


<!-- Popper JS -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.3/umd/popper.min.js"></script>
<script src="https://code.jquery.com/jquery-3.3.1.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/socket.io/2.1.1/socket.io.js">
  
</script>
<script src="//nepalipatro.com.np/widget/js"></script>
<!-- Latest compiled JavaScript -->
<link href="https://fonts.googleapis.com/css?family=Noto+Sans" rel="stylesheet">
  
<script type="text/javascript" src="languagepack/js/jquery.calendars.js"></script>
<script type="text/javascript" src="languagepack/js/jquery.calendars.nepali.js">
</script>
<script type="text/javascript" src="languagepack/js/jquery.calendars.plus.js"></script>

<script type="text/javascript" src="languagepack/js/jquery.calendars.nepali-ne.js"></script>
<link rel="stylesheet" type="text/css" href="languagepack/css/jquery.calendars.picker.css"> 
<script type="text/javascript" src="languagepack/js/jquery.plugin.js"></script> 
<script type="text/javascript" src="languagepack/js/jquery.calendars.picker.js"></script>

  </head>
  <body >
    
      <nav class="navbar navbar-expand-lg ">
        <a class="navbar-brand" href="#">Logo</a>
  <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarSupportedContent" aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
    <span class="navbar-toggler-icon"></span>
  </button>

  <div class="collapse navbar-collapse" id="navbarSupportedContent">
    <ul class="navbar-nav mr-auto">
      <li class="nav-item active">
        <a class="nav-link" href="#">Home <span class="sr-only">(current)</span></a>
      </li>
      <li class="nav-item">
        <a class="nav-link" href="#">Link</a>
      </li>
      <li class="nav-item dropdown">
        <a class="nav-link dropdown-toggle" href="#" id="navbarDropdown" role="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
          Dropdown
        </a>
        <div class="dropdown-menu" aria-labelledby="navbarDropdown">
          <a class="dropdown-item" href="#">Action</a>
          <a class="dropdown-item" href="#">Another action</a>
          <div class="dropdown-divider"></div>
          <a class="dropdown-item" href="#">Something else here</a>
        </div>
      </li>
      <li class="nav-item">
        <a class="nav-link disabled" href="#">Disabled</a>
      </li>
    </ul>
    <form class="form-inline my-2 my-lg-0">
      <h6 class='dates d-inline pt-2 text-danger'>मिति:</h6>
      <h6 class='times ml-1 d-inline pt-2 text-danger'>समय:</h6>
      <h6 class='status ml-1 d-inline pt-2 text-danger'>Not Connected</h6>

    </form>
  </div>
</nav>
    <div class="navbarinclude row">
    <div id="listitem" class='h-100 card col-md-8'>
<!-- <input id='checkdate' type='text'> -->
    </div>
  </div>

    <script type="text/javascript">
      var gc = $.calendars.instance('nepali','ne'); 
     
      var currentdate=gc.newDate();
      var currenttime=new Date();
      var currenttime=currenttime.toLocaleTimeString();

      $('.dates').append("<h6 class='ml-1 d-inline'>"+currentdate+"</h6>");
        $('.times').append("<h6 class='timeupdate ml-1 d-inline'>"+currenttime+"</h6>");
$('.navbarinclude').prepend(navbar);
 sqlconnection();
$('#checkdate').calendarsPicker({calendar: $.calendars.instance('nepali')});
setInterval(checktime,500);
function checktime()
{
  var currenttimenew=new Date().toLocaleTimeString();
  $('.timeupdate').text(currenttimenew);
}
function aamdaanimenu() {
// body...

    var aamdaanimenu="<ul class='aamdaanimenu' style='list-style-type:none;'><li class='d-inline '><button onclick='javascript:aamdaaniselect(event,1)' class=' btn bg-white' style='border-bottom-color:green;'>अाम्दानी थप</button></li><li class='d-inline'><button class='btn bg-white' onclick='javascript:aamdaaniselect(event,2)'' style='border-bottom-color:green;'>अाम्दानी खाेज</button></li><li class='d-inline'><button class='btn bg-white' style='border-bottom-color:green;' onclick='javascript:aamdaaniselect(event,3)'>शीर्षक/उपशीर्षक थप </button></li></ul>";
    aamdaanimenu+=aamdaaniheads();
    aamdaanimenu+='</div></div></form>';
    return aamdaanimenu;
}

function aamdaaniselect(e,value)
{
// var gc = $.calendars.instance('nepali','ne'); 
// alert(gc);
var d = gc.newDate();
// alert(d);
  var e=e || window.event;
  // var value=e.target.value;
  // alert(value);
  var aamdaaniselectdict={1:aamdaaniheads,2:aamdaanikhoj,3:aamdaaniadd};
  $('#aamdaani').remove();
  $('.aamdaanimenu').append(aamdaaniselectdict[value]);
}
function aamdaaniadd()
{
  var aamdaaniadd="<form class='w-100'><div id='aamdaani' class='row mt-5'><div class='col-md-3 '><select onchange='javascript:aamdaaniaddoptions(event)' class='form-control '><option value='1'>शीर्षक थप</option><option value='2'>उपशीर्षक थप</option></select></div><div class='col-md-5'><input class='form-control ' id='aamdaanititleoptioninputadd'><select class='form-control d-none' id='aamdaanititleoptionselectadd'></select><input type='text' class='form-control mt-2 d-none' id='aamdaanisubtitleoptioninputadd'></div><div class='col-md-2 form-group w-75'><a class='btn btn-primary'>Add</a></div></div></form>";
  return aamdaaniadd;
}
function aamdaaniaddoptions(e)
{
var value=e.target.value;
if(value==='1')
{
if(!$('#aamdaanititleoptionselectadd').hasClass('d-none'))
{
$('#aamdaanititleoptionselectadd').addClass('d-none');
}
if(!$('#aamdaanisubtitleoptioninputadd').hasClass('d-none'))
{
$('#aamdaanisubtitleoptioninputadd').addClass('d-none');
}
$('#aamdaanititleoptioninputadd').removeClass('d-none');

}
if(value==='2')
{
if(!$('#aamdaanititleoptioninputadd').hasClass('d-none'))
{
  $('#aamdaanititleoptioninputadd').addClass('d-none');
}
$('#aamdaanititleoptionselectadd').removeClass('d-none');
$('#aamdaanisubtitleoptioninputadd').removeClass('d-none');
var aamdaanilist= "SELECT * FROM aamdanititle ";

connection.query(aamdaanilist,function(err,res,fields){
  if(err) throw err;

  for(var i=0;i<res.length;i++)
  {
      $('#aamdaanititleoptionselectadd').append('<option value="'+res[i].aamdaaniID+'">'+res[i].title+'</option>');
  }
});
}}


function aamdaanikhoj()
{
  var aamdaanikhoj="<form class='w-100' method='post'><div id='aamdaani' class='row text-center'><br/><div class='form-group aamdaanikhoj col-12'><label for='fname' class='d-inline'><br/>खाेज</label></div><div class='form-group  col-4'><select class='form-control d-inline w-100' onchange='javascript:aamdaanikhojvalue(event)'   required><option value='0'>----------------------</option><option value='1'>मिति अनुसार</option><option value='2'>शीर्षक अनुसार</option></select></div> ";

  return aamdaanikhoj;
}

function aamdaanikhojvalue(e)
{
// alert(e);
// alert(date.now());
  var e = window.event || e;
  if(e.target.value==='0')
  {
    $('#aamdaanibytitle').remove();
    $('#aamdaanibydate').remove();
    $('.aamdaanikhojbutton').remove();
    $('.table-placement').remove();
  }
  if(e.target.value==='1')
  {
    // alert(e.target.value);
    $('#aamdaanibytitle').remove();
    $('.aamdaanikhojbutton').remove();
    $('.table-placement').remove();

    $('#aamdaani').append("<div id='aamdaanibydate' class='form-group ml-2 col-md-auto d-inline'><input placeholder='गते/साल/महिना'id='dateaamdaani' class='form-control w-75 d-inline'/><a class='btn  aamdaanikhojbutton btn-md btn-primary ml-2' onclick='javascript:aamdaanikhojbuttons(1)'> खाेज</a></div>");
$('#dateaamdaani').calendarsPicker({calendar: $.calendars.instance('nepali')});

  }
  if(e.target.value==='2')
  {
    // alert(e.target.value);
    $('#aamdaanibydate').remove();
    $('.aamdaanikhojbutton').remove();
    $('.table-placement').remove();
    

     var aamdaanihead="<div style='margin-top:-24px;' id='aamdaanibytitle' class='form-group col-md-auto'><br/><select class='form-control ' id='aamdaanititleoption' required><option value='0'>----------------------</option></select>";

    $('#aamdaani').append(aamdaanihead);

      var aamdaanilist= "SELECT * FROM aamdanititle ";

      connection.query(aamdaanilist,function(err,res,fields){
          if(err) throw err;
          for(var i=0;i<res.length;i++)
          {
              $('#aamdaanititleoption').append('<option value="'+res[i].aamdaaniID+'">'+res[i].title+'</option>');
          }
$('#aamdaani').append("<a class='btn btn-primary h-75 aamdaanikhojbutton' onclick='javascript:aamdaanikhojbuttons(2)'> खाेज</a></div>");
     
});
}
}

function aamdaanikhojbuttons(value)
{
$('.table-placement').remove();
var aamdaanitableplacement="<div class='table-placement col-12'>";
$('#aamdaani').append(aamdaanitableplacement);
$('.table-placement').append('<br/><table class="aamdaanikhojtable table table-striped"><tr><th>Heading 1</th><th>Heading 2</th><th>Heading 3 </th></tr></table></div></div></form>');
}

      function aamdaaniheads()
      {
          

          var aamdaanihead="<form id='aamdaaniform' class='w-100 ' method='post'><div align='center' id='aamdaani'><br/><div class='form-group text-center'><label for='fname' class='d-inline'>अाम्दानीकाे शीर्षक</label><br/><select class='form-control d-inline w-50' onchange='javascript:aamdaanisubtitleoptions(event);' name='aamdaanititleoption' id='aamdaanititleoption' required><option value='0'>----------------------</option></select>";



          var aamdaanilist= "SELECT * FROM aamdanititle ";

          connection.query(aamdaanilist,function(err,res,fields){
              if(err) throw err;
              console.log(res);
              for(var i=0;i<res.length;i++)
              {
                // alert(res[i].aamdaaniID);
                  $('#aamdaanititleoption').append('<option value="'+res[i].aamdaniID+'">'+res[i].title+'</option>');
              }
          $('#aamdaani').append("</div></div></form><div class='form-group text-center'><label for='fname' class='d-inline'>अाम्दानी उपशीर्षक </label><br/><select class='form-control d-inline w-50' name='aamdaanisubtitleoption' id='aamdaanisubtitleoption' required><option value='0'>----------------------</option></select>"); 
          // $('#aamdaani').prepend(aamdaanimenu);
                
                
            });

          return aamdaanihead;
    }

 function aamdaanisubtitleoptions(e)
  {
    e=e || window.event;
  // alert(e.target.value);''
  // alert(e.target.value);
  if(e.target.value>0)
  {
  var search= "SELECT * FROM aamdanisubtitle where aspid="+e.target.value;
  connection.query(search,function(err,res,fields){
      console.log(res);
      if(err) throw err; 
        $('#aamdaanisubtitleoption').text('');

      for(var i=0;i<res.length;i++){
        $('#aamdaanisubtitleoption').append("<option value='"+res[i].asid+"'>"+res[i].astitle+"</option>")
        
      }
      // $('#aamdaani').append('</select>');
     // alert($("#aamdaani").find('div').hasClass("mulye"));
if($("#aamdaani").find('div').hasClass("mulye"))
{

  console.log("Already defined");
}
else{
      $('#aamdaani').append("<div class='mulye w-50 text-center'><label for='Email' >मूल्य</label><br/><input type='number' min='0' name='mulye'  id='email' class=' form-control d-inline ' autofocus/><label for='Email' class='mt-2'>मिति</label><br/><input type='text' id='aamdaanidate' name='aamdaanidate' class=' form-control d-inline ' autofocus/></div><div align='center' class='form-group w-50 mt-3 text-center aamdaanisubmit'><button type='reset' class='form-control w-25 btn btn-primary aamdaanireset'>रद्द गर्नुहाेस</button><a  href='#' class='ml-2  form-control aamdaanisubmit w-25 btn btn-primary btn-sm ' id='aamdaaniform.submit' onclick='javascript:submitdataaamdaani(event)'>थप गर्नुहाेस</a></div></div></form>");
            $('#aamdaanidate').calendarsPicker({calendar: $.calendars.instance('nepali'),dateFormat: 'yyyy-mm-dd'});
    }
    });
  }
  else
{
   $('#aamdaanisubtitleoption').text('');
   $('#aamdaanisubtitleoption').append('<option value="0">--------------</option>');
   if($('#aamdaani').find('div').hasClass('mulye'))
   {

    $('#aamdaani').find('div.mulye').remove();
    // $('#aamdaani').find('div.mulye').removeClass('mulye');
    $('#aamdaani').find('div.aamdaanisubmit').remove();
    $('#aamdaani').find('div.aamdaanireset').remove();


   }

}
}

function kharchamenu() {
  // body...

     var kharchamenu="<ul class='kharchamenu' style='list-style-type:none;'><li class='d-inline '><button onclick='javascript:kharchaselect(event,1)' class=' btn bg-white' style='border-bottom-color:green;'>खर्च थप</button></li><li class='d-inline'><button class='btn bg-white' onclick='javascript:kharchaselect(event,2)'' style='border-bottom-color:green;'>खर्च खाेज</button></li><li class='d-inline'><button class='btn bg-white' style='border-bottom-color:green;' onclick='javascript:kharchaselect(event,3)'>शीर्षक/उपशीर्षक थप</button></li><li class='d-inline'><button class='btn bg-white' style='border-bottom-color:green;' onclick='javascript:kharchaselect(event,4)'>दैनिक रेकर्ड</button></li></ul>";
     kharchamenu+=kharchaheads();
     return kharchamenu;
}

function kharchaselect(e,value)
{
  var e=e || window.event;
  // var value=e.target.value;
  // alert(value);
  var kharchaselectdict={1:kharchaheads,2:kharchakhoj,3:kharchaadd,4:kharchadainiki};
  $('#kharcha').remove();
  $('.kharchamenu').append(kharchaselectdict[value]);
}
function kharchadainiki()
{
  $('.kharchadainikitable').remove();
  // var dainikikharcharecords='SELECT * from kharchatransaction LIMIT 20';
  var dainikikharcharecords='SELECT kharchatitle.KharchaTitle AS titles, kharchasubtitle.kstitle AS subtitle, kharchatransaction.cost AS mulye,kharchatransaction.date as date FROM kharchatransaction LEFT JOIN kharchatitle ON kharchatransaction.kid = kharchatitle.KharchaID LEFT JOIN kharchasubtitle on kharchatransaction.ksid=kharchasubtitle.ksid';
  var dainikikharcha="<table id='kharcha' class='table mt-3 table-hover  kharchadainikitable row'><tr class='col-12 text-center bg-dark text-white'><th>शीर्षक</th><th>उपशीर्षक</th><th>मूल्य</th><th>मिति</th></tr>";
  connection.query(dainikikharcharecords,function(err,result){
    if(err) throw err;
    console.log(result);
    for(var i=0;i<result.length;i++)
    {
    $('.kharchadainikitable').append("<tr class='col-12 text-center thead-primary'><td>"+result[i].titles+"</td><td>"+result[i].subtitle+"</td><td>"+result[i].mulye+"</td><td>"+result[i].date+"</td></tr>");
}
  $('.kharchadainikitable').append("</table></div>");
  
  })
  return dainikikharcha;
}

function kharchaadd()
{
  var kharchaadd="<form id='kharchaaddform' class='w-100'><div id='kharcha' class='row mt-5'><div class='col-md-3 '><select name='addoption' onchange='javascript:kharchaaddoptions(event)' class='form-control '><option value='1'>शीर्षक थप</option><option value='2'>उपशीर्षक थप</option></select></div><div class='col-md-5'><input name='kharchatitleoptioninputadd' class='form-control ' id='kharchatitleoptioninputadd'><select name='kharchatitleoptionselectadd' class='form-control d-none' id='kharchatitleoptionselectadd'></select><input name='kharchasubtitleoptioninputadd' type='text' class='form-control mt-2 d-none' id='kharchasubtitleoptioninputadd'></div><div class='col-md-2 form-group w-75'><a href='#' onclick='javascript:kharchatitleadd()' class='btn btn-primary'>Add</a></div></div></form>";
  return kharchaadd;
}

function kharchatitleadd()
{
var kharchaoptionadd=$('#kharchaaddform').serializeArray();
console.log(kharchaoptionadd);
if(!$('#kharchasubtitleoptioninputadd').hasClass('d-none'))
{
  var kharchasubtitleresult=[[kharchaoptionadd[3]['value'],kharchaoptionadd[2]['value']]];
  var kharchasubtitleaddquery="INSERT INTO kharchasubtitle (kstitle,kspid) VALUES ?";
  connection.query(kharchasubtitleaddquery,[kharchasubtitleresult],function(err,result)
  {
    if(err) throw err;

  });
}

if(!$('#kharchatitleoptioninputadd').hasClass('d-none'))
{
  var kharchatitleresult=[[kharchaoptionadd[1]['value']]]
  var kharchatitleaddquery="INSERT into kharchatitle (KharchaTitle) values ?";
  connection.query(kharchatitleaddquery,[kharchatitleresult],function(err,result)
  {
    if(err) throw err;
    alert("Inserted");
  });
}
}

function kharchaaddoptions(e)
{
var value=e.target.value;
if(value==='1')
{
if(!$('#kharchatitleoptionselectadd').hasClass('d-none'))
{
$('#kharchatitleoptionselectadd').addClass('d-none');
}
if(!$('#kharchasubtitleoptioninputadd').hasClass('d-none'))
{
$('#kharchasubtitleoptioninputadd').addClass('d-none');
}
$('#kharchatitleoptioninputadd').removeClass('d-none');

}
if(value==='2')
{
if(!$('#kharchatitleoptioninputadd').hasClass('d-none'))
{
  $('#kharchatitleoptioninputadd').addClass('d-none');
}
$('#kharchatitleoptionselectadd').removeClass('d-none');
$('#kharchasubtitleoptioninputadd').removeClass('d-none');
var kharchalist= "SELECT * FROM kharchatitle ";

connection.query(kharchalist,function(err,res,fields){
  if(err) throw err;
  // alert(res.length);
  for(var i=0;i<res.length;i++)
  {
      $('#kharchatitleoptionselectadd').append('<option value="'+res[i].KharchaID+'">'+res[i].KharchaTitle+'</option>');
  }
});
}}

function kharchakhoj()
{
  var kharchakhoj="<form class='w-100' id='kharchakhojform' method='post'><div id='kharcha' class='row text-center'><br/><div class='form-group kharchakhoj col-12'><label for='fname' class='d-inline'><br/>खाेज</label></div><div class='form-group  col-4'><select class='form-control d-inline w-100' name='kharchakhojoption' onchange='javascript:kharchakhojvalue(event)'   required><option value='0'>----------------------</option><option value='1'>मिति अनुसार</option><option value='2'>शीर्षक अनुसार</option></select></div> ";

  return kharchakhoj;
}

function kharchakhojvalue(e)
{
// alert(e);
  var e = window.event || e;
  if(e.target.value==='0')
  {
    $('#kharchabytitle').remove();
    $('#kharchabydate').remove();
    $('.kharchakhojbutton').remove();
    $('.table-placement').remove();
  }
  if(e.target.value==='1')
  {
    // alert(e.target.value);
    $('#kharchabytitle').remove();
    $('.kharchakhojbutton').remove();
    $('.table-placement').remove();
    $('.kharchakhojtable1').remove();
    $('.kharchakhojtable2').remove();

    $('#kharcha').append("<div id='kharchabydate' class='form-group ml-2 col-md-auto d-inline'><input id='datekharcha1' style='width:140px;' name='datekharcha1' placeholder='सुरु मिति' class='form-control d-inline'><input id='datekharcha2' style='width:140px;' name='datekharcha2' placeholder='अन्तिम मिति' class='form-control ml-2 d-inline'><a class='btn  kharchakhojbutton btn-md btn-primary ml-2' onclick='javascript:kharchakhojbuttons(1)'> खाेज</a></div>");
$('#datekharcha1').calendarsPicker({calendar: $.calendars.instance('nepali'),dateFormat: 'yyyy-mm-dd'});

$('#datekharcha2').calendarsPicker({calendar: $.calendars.instance('nepali'),dateFormat: 'yyyy-mm-dd'});

  }
  if(e.target.value==='2')
  {
    // alert(e.target.value);
    $('#kharchabydate').remove();
    $('.kharchakhojbutton').remove();
    $('.kharchakhojtable1').remove();
    $('.kharchakhojtable2').remove();

    $('.table-placement').remove();
    

     var kharchahead="<div style='margin-top:-24px;' id='kharchabytitle' class='form-group col-md-auto'><br/><select class='form-control ' name='kharchatitleoption' id='kharchatitleoption' required><option value='0'>----------------------</option></select>";

    $('#kharcha').append(kharchahead);

      var kharchalist= "SELECT * FROM kharchatitle ";

      connection.query(kharchalist,function(err,res,fields){
          if(err) throw err;
          for(var i=0;i<res.length;i++)
          {
              $('#kharchatitleoption').append('<option value="'+res[i].KharchaID+'">'+res[i].KharchaTitle+'</option>');
          }
$('#kharcha').append("<a class='btn btn-primary h-75 kharchakhojbutton' onclick='javascript:kharchakhojbuttons(2)'> खाेज</a></div>");
     
});
}
}

function kharchakhojbuttons(value)
{
// $('.table-placement').remove();
// alert(value);
if(value===1)
{
  $('.kharchakhojtable2').remove();
  $('.kharchakhojtable1').remove();


  // $('#kharcha').remove();
  var kharchakhojdate1=$('#datekharcha1').val();
  var kharchakhojdate2=$('#datekharcha2').val();
  alert(kharchakhojdate1);
  // kharchakhojdate1=kharchakhojdate1.toLocaleDateString();
  // kharchakhojdate2=kharchakhojdate2.toLocaleDateString();
  // alert(kharchakhojdate1);

  var kharchakhojquery='SELECT kharchatitle.KharchaTitle AS titles, kharchasubtitle.kstitle AS subtitle, SUM(kharchatransaction.cost) AS mulye,max(kharchatransaction.date) as date FROM kharchatransaction LEFT JOIN kharchatitle ON kharchatransaction.kid = kharchatitle.KharchaID LEFT JOIN kharchasubtitle on kharchatransaction.ksid=kharchasubtitle.ksid  where kharchatransaction.date between ? and ? group by kharchatransaction.ksid,kharchatransaction.kid ';
  connection.query(kharchakhojquery,[kharchakhojdate1,kharchakhojdate2],function(err,res,fields){
    if(err) throw err;
    $('#kharcha').append("<table id='kharcha' class='table mt-3 table-hover  kharchakhojtable1 row'><tr><th>शीर्षक</th><th>उपशीर्षक</th><th>मूल्य</th></tr>");
    console.log(res.length);
    for(var i=0;i<res.length;i++)
    {
      $('.kharchakhojtable1').append("<tr><td>"+res[i].titles+"</td><td>"+res[i].subtitle+"</td><td>"+res[i].mulye+"</td></tr>");
    }
  })
  $('.kharchakhojtable1').append('</table>')
}
if(value===2)
{
  $('.kharchakhojtable1').remove();
  $('.kharchakhojtable2').remove();

  // alert("Value:2");
  var kharchakhojtitle=$('#kharchatitleoption').val();
  var kharchakhojquery='SELECT kharchatitle.KharchaTitle AS titles, kharchatransaction.kid as kid ,kharchasubtitle.kstitle AS subtitle, kharchatransaction.cost AS mulye,kharchatransaction.date as date FROM kharchatransaction LEFT JOIN kharchatitle ON kharchatransaction.kid = kharchatitle.KharchaID LEFT JOIN kharchasubtitle on kharchatransaction.ksid=kharchasubtitle.ksid where kid='+ sql.escape(kharchakhojtitle);
  connection.query(kharchakhojquery,function(err,res,fields){
    if(err) throw err;
    $('#kharcha').append("<table class='table mt-3 table-hover  kharchakhojtable1 row'><tr bg-dark text-white'><th>शीर्षक</th><th>उपशीर्षक</th><th>मूल्य</th><th>मिति</th></tr>");
    console.log(res.length);
    for(var i=0;i<res.length;i++)
    {
      $('.kharchakhojtable1').append("<tr><td>"+res[i].titles+"</td><td>"+res[i].subtitle+"</td><td>"+res[i].mulye+"</td><td>"+res[i].date+"</td></tr>");

    }
  })
  $('.kharchakhojtable1').append("</table>");
}

// var kharchatableplacement="<div class='table-placement col-12'>";
// var kharchakhojdata=$('#kharchakhojform').serializeArray();
// console.log(kharchakhojdata);
// $('#kharcha').append(kharchatableplacement);
// $('.table-placement').append('<br/><table class="kharchakhojtable table table-striped"><tr><th>Heading 1</th><th>Heading 2</th><th>Heading 3 </th></tr></table></div></div></form>');
}

function kharchaheads()
{

var kharchahead="<form class='w-100' id='kharchaform' method='post'><div align='center' id='kharcha'><br/><div class='form-group text-center'><label for='fname' class='d-inline'>खर्चकाे शीर्षक</label><br/><select class='form-control d-inline w-50' onchange='javascript:kharchasubtitleoptions(event);'  id='kharchatitleoption' name='kharchatitleoption' required><option value='0'>----------------------</option></select>";



var kharchalist= "SELECT * FROM kharchatitle ";

connection.query(kharchalist,function(err,res,fields){
    if(err) throw err;
    for(var i=0;i<res.length;i++)
    {
        $('#kharchatitleoption').append('<option value="'+res[i].KharchaID+'">'+res[i].KharchaTitle+'</option>');
    }
$('#kharcha').append("</div></div></form><div class='form-group text-center'><label for='fname' class='d-inline'>खर्चकाे उपशीर्षक</label><br/><select class='form-control d-inline w-50'  id='kharchasubtitleoption' name='kharchasubtitleoption' required><option value='0'>----------------------</option></select>"); 
// $('#kharcha').prepend(kharchamenu);
      
      
  });

return kharchahead;
}

 function kharchasubtitleoptions(e)
  {
    e=e || window.event;
    var date= new Date();
    // alert(date);
  // alert(e.target.value);''
  if(e.target.value>0)
  {
  var search= "SELECT * FROM kharchasubtitle where kspid="+e.target.value;
  connection.query(search,function(err,res,fields){
      console.log(res);
      if(err) throw err; 
        $('#kharchasubtitleoption').text('');

      for(var i=0;i<res.length;i++){
        $('#kharchasubtitleoption').append("<option value='"+res[i].ksid+"'>"+res[i].kstitle+"</option>")
        
      }
      // $('#kharcha').append('</select>');
     // alert($("#kharcha").find('div').hasClass("mulye"));
if($("#kharcha").find('div').hasClass("mulye"))
{

  console.log("Already defined");
}
else{
  var kharchaform='kharchaform';
      $('#kharcha').append("<div class='mulye w-50 text-center'><label for='Email' >मूल्य</label><br/><input type='number'  id='mulye' name='mulye' class=' form-control d-inline ' autofocus/><label for='Email' class='mt-2'>मिति</label><br/><input type='text' id='kharchadate' name='kharchadate' class=' form-control d-inline ' autofocus/></div><div align='center' class='form-group w-50 mt-3 text-center kharchasubmit'><button type='reset' class='form-control w-25 btn btn-primary kharchareset'>रद्द गर्नुहाेस</button><a  class='ml-2  form-control kharchasubmit w-25 btn btn-primary btn-sm ' href='#' id='kharchaform.submit' onclick='javascript:submitdatakharcha(event)'>Submit</a></div></div></form>");
      $('#kharchadate').calendarsPicker({calendar: $.calendars.instance('nepali'),dateFormat: 'yyyy-mm-dd'});
    }
    });
  }
  else
{
   $('#kharchasubtitleoption').text('');
   $('#kharchasubtitleoption').append('<option value="0">--------------</option>');
   if($('#kharcha').find('div').hasClass('mulye'))
   {

    $('#kharcha').find('div.mulye').remove();
    // $('#aamdaani').find('div.mulye').removeClass('mulye');
    $('#kharcha').find('div.kharchasubmit').remove();
    $('#aamdaani').find('div.kharchareset').remove();


   }

}
}

function submitdataaamdaani(e)
{
  var submitvalue=e.target.id;
  var submitvalue=submitvalue.split('.');
  alert(submitvalue);
  var a=$('#'+submitvalue).serializeArray();
  alert(a);
  for(var i=0;i<a.length;i++)
  {
    console.log(a[i]);
  }
  // console.log(a[0]['value']);
  
  if(a[0]['value']>0 && a[1]['value']>0)
  {
     var date=new Date();
     var currentdate=gc.newDate();
     // var date=Date.toLocaleDateString();

     var aamdaanidata=[[a[0]['value'],a[1]['value'],a[2]['value'],a[3]['value']]];
     // var sql = "INSERT INTO customers (name, address) VALUES ('Company Inc', 'Highway 37')";
    var insertaamdaanidata= "INSERT INTO aamdaanitransaction (aid,asid,cost,date) VALUES ? "
    connection.query(insertaamdaanidata,[aamdaanidata],function(err,result)
    {
      
      if (err) throw err;
    console.log("Number of records inserted: " + result.affectedRows);
    });
    $('.aamdaanireset').click();
    $('#aamdaanisubtitleoption').text('');
    $('#aamdaanisubtitleoption').append('<option value="0">-----------------------------------</option>');
  }
}
function submitdatakharcha(e)
{
  var submitvalue=e.target.id;
  var submitvalue=submitvalue.split('.');
  var a=$('#'+submitvalue).serializeArray();
  // console.log(a[0]['value']);
  
  if(a[0]['value']>0 && a[1]['value']>0)
  {
     // var currentdate=gc.newDate();
     var kharchadata=[[a[0]['value'],a[1]['value'],a[2]['value'],a[3]['value']]];
     console.log(kharchadata);
     // var sql = "INSERT INTO customers (name, address) VALUES ('Company Inc', 'Highway 37')";
    var insertkharchadata= "INSERT INTO kharchatransaction (kid,ksid,cost,date) VALUES ? "
    connection.query(insertkharchadata,[kharchadata],function(err,result)
    {
      
      if (err) throw err;
    console.log("Number of records inserted: " + result.affectedRows);
    $('.kharchareset').click();
    $('#kharchasubtitleoption').text('');
    $('#kharchasubtitleoption').append('<option value="0">-----------------------------------</option>');

    });
    
  }
}
  // alert(a);

      // var listmenu={1:aamdani,2:kharchahead,3:upavokta,4:padhadhikari,5:kaathbibaran};
      // var listmenu={1:aamdaaniheads,2:kharchaheads,3:upavokta,4:padhadhikari,5:kaathbibaran};
      var listmenu={1:aamdaanimenu,2:kharchamenu,3:upavokta,4:padhadhikari,5:kaathbibaran};
    

      function showoption(value)
      {
          event.preventDefault();
          $('#listitem').html('');
          $('#listitem').prepend(listmenu[value]);
$('#startdate').calendarsPicker({calendar: $.calendars.instance('nepali')});
$('#enddate').calendarsPicker({calendar: $.calendars.instance('nepali')});

      }


// swal({
//   title: "Are you sure?",
//   text: "Are you sure that you want to leave this page?",
//   icon: "warning"
// })
// .then(willDeletes => {
//   if (willDeletes) {
//     swal("Deleted!", "Your imaginary file has been deleted!"+willDeletes, "success");
//   }
// });
    </script>
  </body>
</html>